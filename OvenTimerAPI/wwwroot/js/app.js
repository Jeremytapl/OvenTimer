(function(t){function e(e){for(var r,o,a=e[0],l=e[1],c=e[2],h=0,m=[];h<a.length;h++)o=a[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(m.length)m.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],r=!0,a=1;a<i.length;a++){var l=i[a];0!==s[l]&&(r=!1)}r&&(n.splice(e--,1),t=o(o.s=i[0]))}return t}var r={},s={app:0},n=[];function o(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=r,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(i,r,function(e){return t[e]}.bind(null,r));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=l;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"310d":function(t,e,i){"use strict";var r=i("d6af"),s=i.n(r);s.a},"56d7":function(t,e,i){"use strict";i.r(e);var r=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",{attrs:{id:"app"}},[i("v-app-bar",{attrs:{app:"","clipped-left":""}},[i("v-toolbar-title",[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$router.push("/")}}},[t._v("Timer")])])],1),i("v-content",[i("v-container",{attrs:{fluid:""}},[t.showError?i("v-row",{attrs:{justify:"center"}},[i("v-alert",{attrs:{dismissible:"",type:"error"}},[t._v("\n            "+t._s(t.errorText)+"\n          ")])],1):t._e(),i("router-view")],1)],1)],1)},n=[],o={components:{},created(){document.title="Timer",this.$vuetify.theme.dark=!0,this.$root.$on("error",this.showErrorAlert)},data(){return{errorText:"",errorTitle:"",showError:!1}},watch:{$route(t){document.title=null!=t?"Timer - "+t.name:"Timer"},showError:function(t){t||(this.errorText="")}},methods:{showErrorAlert:function(t,e){this.errorText=t,this.errorTitle=this.$isNullOrWhitespace(e)?"Error":"Error - "+e,this.showError=!0}}},a=o,l=i("2877"),c=i("6544"),u=i.n(c),h=i("0798"),m=i("7496"),d=i("40dc"),p=i("a523"),f=i("a75b"),v=i("0fd9"),g=i("2a7f"),b=Object(l["a"])(a,s,n,!1,null,null,null),w=b.exports;u()(b,{VAlert:h["a"],VApp:m["a"],VAppBar:d["a"],VContainer:p["a"],VContent:f["a"],VRow:v["a"],VToolbarTitle:g["a"]});var C=i("8c4f"),T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("timers")],1)},y=[],V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.showLoader?i("loader"):t._e(),i("v-row",{attrs:{justify:"center"}},[i("v-col",{attrs:{cols:"1"}},[i("v-text-field",{staticClass:"display-1",attrs:{error:!t.hourValid,label:"COM Port",placeholder:"9",outlined:"",value:t.comPort},on:{change:function(e){t.comPort=e}}})],1),i("v-col",{attrs:{cols:"2"}},[i("v-text-field",{staticClass:"display-1",attrs:{error:!t.hourValid,label:"Number of Timers",placeholder:"10",outlined:"",value:t.count},on:{change:function(e){t.count=e}}})],1),i("v-col",{attrs:{cols:"2"}},[i("v-text-field",{staticClass:"display-1",attrs:{error:!t.hourValid,label:"Default Hours",placeholder:"00",outlined:"",value:t.hour},on:{change:function(e){t.hour=e}}})],1),i("span",{staticClass:"display-3"},[t._v(":")]),i("v-col",{attrs:{cols:"2"}},[i("v-text-field",{staticClass:"display-1",attrs:{error:!t.minuteValid,label:"Default Minutes",placeholder:"00",outlined:"",value:t.minute},on:{change:function(e){t.minute=e}}})],1),i("span",{staticClass:"display-3"},[t._v(":")]),i("v-col",{attrs:{cols:"2"}},[i("v-text-field",{staticClass:"display-1",attrs:{error:!t.secondValid,label:"Default Seconds",placeholder:"00",outlined:"",value:t.second},on:{change:function(e){t.second=e}}})],1),i("v-col",{attrs:{cols:"2"}},[i("v-btn",{staticClass:"mt-2",attrs:{disabled:!t.timeValid,large:"",color:"primary"},on:{click:t.setDefaultTime}},[t._v("Set / Reset")])],1)],1),t.showClocks?i("v-row",{attrs:{justify:"center","no-gutters":""}},t._l(t.items,(function(e){return i("v-col",{key:e.id,ref:"items",refInFor:!0,attrs:{cols:"3",justify:"center"}},[i("timer",{ref:"item-"+e.id,refInFor:!0,attrs:{caption:e.id,"default-value":t.defaultTime,"timer-id":e.id},model:{value:e.time,callback:function(i){t.$set(e,"time",i)},expression:"item.time"}})],1)})),1):t._e()],1)},S=[],$=i("1a9a"),x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"text-center"},[i("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-card",{attrs:{color:"primary",dark:""}},[i("v-card-text",[t._v("\n        "+t._s(t.$isNullOrWhitespace(t.text)?"Loading...":t.text)+"\n        \n        "),i("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},_=[],k={props:{text:String},data(){return{show:!0}}},O=k,P=i("b0af"),E=i("99d9"),j=i("169a"),I=i("8e36"),N=Object(l["a"])(O,x,_,!1,null,null,null),F=N.exports;u()(N,{VCard:P["a"],VCardText:E["a"],VDialog:j["a"],VProgressLinear:I["a"]});var L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.timerCSSClass},[i("div",{staticClass:"ml-3 display-1"},[i("div",{staticClass:"timer-label"},[t._v(t._s(t.$isNullOrWhitespace(t.caption)?"":"Timer "+t.caption+":"))])]),i("div",{class:"timer-container",attrs:{"no-gutters":""},on:{change:function(e){return t.$emit("input",t.value)}}},[i("div",{on:{keypress:function(e){t.showSaveBtn=!0}}},[i("span",[i("v-text-field",{staticClass:"display-1 input-size inline-block",attrs:{placeholder:"00",value:t.hour},on:{change:function(e){t.hour=e}}})],1),i("span",{staticClass:"ml-1 display-2 inline-block"},[t._v(":")]),i("span",[i("v-text-field",{staticClass:"display-1 input-size inline-block",attrs:{placeholder:"00",value:t.minute},on:{change:function(e){t.minute=e}}})],1),i("span",{staticClass:"ml-1 display-2 inline-block"},[t._v(":")]),i("span",[i("v-text-field",{staticClass:"display-1 input-size inline-block",attrs:{placeholder:"00",value:t.second},on:{change:function(e){t.second=e}}})],1),t.showSaveBtn?i("span",{staticClass:"inline-block"},[i("v-btn",{staticClass:"ml-2 mb-3",attrs:{small:"",color:"success"},on:{click:function(e){t.showSaveBtn=!1}}},[t._v("Save")])],1):t._e(),i("span",[i("v-btn",{staticClass:"ml-2 mb-3",attrs:{small:"",color:"warning"},on:{click:function(e){return t.reset(!0)}}},[i("i",{staticClass:"material-icons"},[t._v("refresh")])])],1)])])])},M=[],W={props:{caption:null,defaultValue:{type:String},timerId:{required:!0,type:String},value:{required:!0,type:String}},created(){this.parseValue()},data(){return{isComplete:!1,inProcess:!1,initValue:this.value,hour:"",minute:"",second:"",showSaveBtn:!1,started:!1,timer:null,timerCSSClass:"timer "}},watch:{isComplete:function(t){t?(this.timerCSSClass="timer timer-success",this.stopTimer(),this.inProcess=!1):this.timerCSSClass="timer "},inProcess:function(t){t?this.timerCSSClass="timer timer-processing":this.isComplete||(this.timerCSSClass="timer ")},started:function(t){t?this.startTimer():this.stopTimer()},value:function(t){this.initValue=t,this.parseValue()}},methods:{parseValue:function(){if(null!=this.initValue){let t="00:00:00"==this.initValue&&null!=this.defaultValue?this.defaultValue:this.initValue,e=t.toString().split(":");3==e.length&&(this.hour=e[0],this.minute=e[1],this.second=e[2]),"00"==this.hour&&"00"==this.minute&&"00"==this.second&&(this.isComplete=!0)}},reset:function(t){(this.isComplete||t)&&(this.isComplete=!1,this.inProcess=!1,this.stopTimer(),this.parseValue())},startTimer:function(){if(null==this.timer){let t=Number.parseInt(this.hour),e=Number.parseInt(this.minute),i=Number.parseInt(this.second),r=this;this.timer=setInterval((function(){if(0==t&&0==e&&0==i)return r.isComplete=!0,void clearInterval(r.timer);r.inProcess=!0,t>0&&0==e&&t--,e>0&&0==i?e--:0!=t&&0==e&&0==i&&(e=59),i>0?i--:0==i&&(i=59),r.hour=r.$getFormatTime(t),r.minute=r.$getFormatTime(e),r.second=r.$getFormatTime(i),r.updateService()}),1e3)}},stopTimer:function(){clearInterval(this.timer),this.timer=null,delete this.timer},toggle:function(){this.started=!this.started},updateService:async function(){let t={id:this.timerId.toString(),hour:this.hour.toString(),minute:this.minute.toString(),second:this.second.toString()};await this.$http.patch("timer",t).catch(t=>{this.$showError(t,"Update Timer")})}}},B=W,D=(i("310d"),i("8336")),A=i("8654"),R=Object(l["a"])(B,L,M,!1,null,"4c83d492",null),z=R.exports;u()(R,{VBtn:D["a"],VTextField:A["a"]});var q={components:{loader:F,timer:z},created(){this.loadTimers()},data(){return{comPort:"9",count:10,hour:"00",items:[],minute:"30",second:"00",showClocks:!1,showLoader:!1}},computed:{defaultTime:function(){return this.hour+":"+this.minute+":"+this.second},hourValid:function(){return this.isValid(this.hour)},minuteValid:function(){return this.isValid(this.minute)},secondValid:function(){return this.isValid(this.second)},timeValid:function(){return this.hourValid&&this.minuteValid&&this.secondValid}},watch:{hour:function(t){t.length<2&&(this.hour=this.$getFormatTime(t))},minute:function(t){t.length<2&&(this.minute=this.$getFormatTime(t))},second:function(t){t.length<2&&(this.second=this.$getFormatTime(t))},showClocks:function(t){t&&this.listenForTimers()}},methods:{createItems:async function(){this.items=[],this.showClocks=!1;for(let i=1;i<Number.parseInt(this.count)+1;i++){let t={id:i.toString(),hour:this.hour,minute:this.minute,second:this.second};t.time=this.getTimeValue(t),this.items.push(t)}let t={defaults:{comport:this.comPort,hour:this.hour,minute:this.minute,second:this.second,timers:Number.parseInt(this.count)},timesets:this.items};await this.$http.post("timer",t).catch(t=>{this.$showError(t,"Set Timers")});let e=this;this.$nextTick(()=>{e.showClocks=!0})},getTimeValue:function(t){return`${t.hour}:${t.minute}:${t.second}`},isValid:function(t){return!this.$isNullOrWhitespace(t)&&!isNaN(t)},listenForTimers:function(){const t=(new $["b"]).withUrl("timerHub",{transport:$["a"].ServerSentEvents|$["a"].LongPolling}).configureLogging($["c"].Information).build();let e=this;t.start().then(()=>{t.on("ReceiveInput",t=>{let i="item-"+t.trim().replace("-","").replace("x","");null!=e.$refs[i]&&e.$refs[i].length&&(t.toString().trim().endsWith("x")?e.$refs[i][0].reset():e.$refs[i][0].startTimer())});let i=e.$isNullOrWhitespace(e.comPort)||e.comPort.toString().startsWith("COM")?e.comPort:"COM"+e.comPort;t.invoke("StartListener",i).catch((function(t){e.$showError(t,"Timer Listener")}))}).catch(t=>{e.$showError(t,"Timer Service Connection")})},loadTimers:async function(){this.showLoader=!0,await this.$http.get("timer").then(t=>{if(t.data){if(t.data.defaults){let e=t.data.defaults;this.comPort=e.comPort,this.hour=e.hour,this.minute=e.minute,this.second=e.second,e.timers&&(this.count=Number.parseInt(e.timers))}if(t.data.timeSets&&t.data.timeSets.length){this.items=t.data.timeSets;for(let t of this.items)t.time=this.getTimeValue(t);this.showClocks=!0}}}).catch(t=>{this.$showError(t,"Get Timers")}),this.showLoader=!1},setDefaultTime:function(){this.timeValid&&this.createItems()}}},H=q,J=i("62ad"),U=Object(l["a"])(H,V,S,!1,null,"526157f1",null),G=U.exports;u()(U,{VBtn:D["a"],VCol:J["a"],VRow:v["a"],VTextField:A["a"]});var K={components:{timers:G}},Q=K,X=Object(l["a"])(Q,T,y,!1,null,null,null),Y=X.exports;r["a"].use(C["a"]);var Z=new C["a"]({routes:[{path:"/",name:"home",component:Y}]}),tt=i("f309");r["a"].use(tt["a"]);var et=new tt["a"]({icons:{iconfont:"mdi"}}),it=i("bc3a"),rt=i.n(it),st={methods:{$getFormatTime:function(t){return t<10&&(t="0"+t),t},$isNullOrWhitespace(t){let e=null==t||null!==t.toString().match(/^ *$/);return e},$showError(t,e){this.$root.$emit("error",t,e)}}};r["a"].prototype.$http=rt.a,r["a"].config.productionTip=!1,r["a"].mixin(st),new r["a"]({router:Z,vuetify:et,render:t=>t(w)}).$mount("#app")},d6af:function(t,e,i){}});
//# sourceMappingURL=app.js.map